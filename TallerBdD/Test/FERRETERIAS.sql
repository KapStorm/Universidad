CREATE DATABASE FERRETERIAS
GO
USE FERRETERIAS
GO --CREACION DE TABLAS
CREATE TABLE ZONAS(
ZONAID INT NOT NULL,
ZONANOMBRE NVARCHAR(20) NOT NULL)
GO

CREATE TABLE MUNICIPIOS(
MUNID INT NOT NULL,
MUNNOMBRE NVARCHAR(50) NOT NULL)
GO
CREATE TABLE COLONIAS(
COLID INT NOT NULL,
COLNOMBRE NVARCHAR (50) NOT NULL,
COLCP NCHAR(5) NULL,
MUNID INT NOT NULL) 
GO
CREATE TABLE FAMILIAS(
FAMID INT NOT NULL,
FAMNOMBRE NVARCHAR(50) NOT NULL,
FAMDESCRIPCION NVARCHAR(200) NULL)
GO
CREATE TABLE FERRETERIAS(
FERREID INT NOT NULL,
FERRENOMBRE NVARCHAR (20) NOT NULL,
FERRDOMICILIO NVARCHAR(50) NOT NULL,
FERRTELEFONO NCHAR(10) NOT NULL)
GO
CREATE TABLE EMPLEADOS(
EMPID INT NOT NULL,
EMPNOMBRE NVARCHAR(50) NOT NULL,
EMPAPEPAT NVARCHAR(50) NOT NULL,
EMPAPEMAT NVARCHAR(50) NULL,
EMPDOM NVARCHAR (50) NOT NULL,
EMPTELEFONO NCHAR (10) NULL,
EMPCELULAR NCHAR(10) NULL,
EMPRFC NCHAR (13) NULL,
EMPCURP NCHAR(18) NULL,
EMPFECHAINGRESO DATETIME NOT NULL,
EMPFECHANACIMIENTO DATETIME NOT NULL,
ZONAID INT NOT NULL,
JEFEID INT NOT NULL)
GO
CREATE TABLE CLIENTES(
CTEID INT NOT NULL,
CTENOMBRE NVARCHAR(20) NOT NULL,
CTEAPEPAT NVARCHAR(50) NOT NULL,
CTEAPEMAT NVARCHAR(50) NULL,
CTEDOMICILIO NVARCHAR(50) NOT NULL,
CTETELEFONO NCHAR(10) NULL,
CTECELULAR NCHAR(10) NULL, 
CTERFC NCHAR(13) NULL,
CTECUR NCHAR(18) NULL,
CTEFECHANACIMIENTE DATETIME NOT NULL,
CTESEXO NCHAR(1) NOT NULL,
COLID INT NOT NULL)
GO
CREATE TABLE ARTICULOS(
ARTID INT NOT NULL,
ARTNOMBRE NVARCHAR(20) NOT NULL,
ARTDESCRIPCION NVARCHAR(200) NOT NULL,
ARTPRECIO NUMERIC(10 , 2) NOT NULL,
FAMID INT NOT NULL)
GO
CREATE TABLE VENTAS(
FOLIO INT NOT NULL,
FECHA DATETIME NOT NULL,
FERREID INT NOT NULL,
CTEID INT NOT NULL,
EMPID INT NOT NULL)
GO
CREATE TABLE DETALLE(
FOLIO INT NOT NULL,
ARTID INT NOT NULL,
CANTIDAD NUMERIC(7, 2) NOT NULL,
PRECIO NUMERIC(10, 2) NOT NULL)
GO
--CREACION DE PRIMARY 



ALTER TABLE DETALLE ADD CONSTRAINT PK_DETALLE PRIMARY KEY (FOLIO, ARTID)



ALTER TABLE ZONAS ADD CONSTRAINT PK_ZONAS PRIMARY KEY (ZONAID)
ALTER TABLE FAMILIAS ADD CONSTRAINT PK_FAMILIAS PRIMARY KEY (FAMID)
ALTER TABLE ARTICULOS ADD CONSTRAINT PK_ARTICULOS PRIMARY KEY (ARTID)
ALTER TABLE MUNICIPIOS ADD CONSTRAINT PK_MUNICIPIOS PRIMARY KEY (MUNID)
ALTER TABLE COLONIAS ADD CONSTRAINT PK_COLONIAS PRIMARY KEY (COLID)
ALTER TABLE CLIENTES ADD CONSTRAINT PK_CLIENTES PRIMARY KEY (CTEID)
ALTER TABLE EMPLEADOS ADD CONSTRAINT PK_EMP PRIMARY KEY (EMPID)
ALTER TABLE FERRETERIAS ADD CONSTRAINT PK_FERRETERIA PRIMARY KEY (FERREID)
ALTER TABLE VENTAS ADD CONSTRAINT PK_VENTA PRIMARY KEY (FOLIO)
GO


--CREACION DE FOREIGN KEYS
ALTER TABLE ARTICULOS ADD CONSTRAINT FK_ART_FAM FOREIGN KEY (FAMID) REFERENCES FAMILIAS (FAMID)

ALTER TABLE COLONIAS ADD CONSTRAINT FK_COLONIAS_MUN FOREIGN KEY (MUNID) REFERENCES MUNICIPIOS (MUNID)
ALTER TABLE CLIENTES ADD CONSTRAINT FK_CLIENTES_COL FOREIGN KEY(COLID) REFERENCES COLONIAS(COLID)
ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMP_ZONA FOREIGN KEY (ZONAID) REFERENCES ZONAS (ZONAID)


--ASOSIACION UNARIA (UN EMPLEADO TIENE A SU CARGO MUCHOS EMPLEADOS)
ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMP_JEFE FOREIGN KEY (JEFEID) REFERENCES EMPLEADOS (EMPID)
ALTER TABLE VENTAS ADD CONSTRAINT FK_VENTAS_FERRETERIA FOREIGN KEY (FERREID) REFERENCES FERRETERIAS (FERREID) 
ALTER TABLE VENTAS ADD CONSTRAINT FK_VENTAS_CLIENTES FOREIGN KEY (CTEID) REFERENCES CLIENTES (CTEID)
ALTER TABLE VENTAS ADD CONSTRAINT FK_VENTAS_EMPLEADO FOREIGN KEY (EMPID) REFERENCES EMPLEADOS (EMPID)
GO
ALTER TABLE DETALLE ADD CONSTRAINT FK_DETALLE_ARTIC FOREIGN KEY (ARTID) REFERENCES ARTICULOS (ARTID),
CONSTRAINT FK_DETALLE_VENTAS FOREIGN KEY (FOLIO) REFERENCES VENTAS(FOLIO)
GO
--UNIQUE KEYS
GO



ALTER TABLE CLIENTES ADD CONSTRAINT UC_CLIENTES_RFC UNIQUE (CTERFC)



CONSTRAINT UC_CLIENTES_CURP UNIQUE (CTECUR)



GO
ALTER TABLE EMPLEADOS ADD CONSTRAINT UC_EMPLEADOS_RFC UNIQUE (EMPRFC),
CONSTRAINT UC_EMPLEADOS_CURP UNIQUE (EMPCURP)
GO
--CHECK CONSTRAIN




ALTER TABLE CLIENTES ADD CONSTRAINT CC_CLIENTES_SEXO CHECK (CTESEXO IN('F','M')),




CONSTRAINT CC_CLIENTES_RFC_CURP CHECK (CTERFC <> CTECUR)




GO
ALTER TABLE DETALLE ADD CONSTRAINT CC_DETALLE_PRECIO CHECK (PRECIO > 0),
CONSTRAINT CC_DETALLE_CANTIDAD CHECK (CANTIDAD > 0)
GO



ALTER TABLE ARTICULOS ADD CONSTRAINT CC_ARTICULOS_PRECIO CHECK (ARTPRECIO > 0)




GO
ALTER TABLE VENTAS ADD CONSTRAINT CC_VENTAS_FECHA CHECK (FECHA > '1-1-2018')
GO
--DEFAULT CONSTRAIN
ALTER TABLE EMPLEADOS ADD CONSTRAINT DC_EMPLEADOS_DOMICILIO DEFAULT('SIN DOMICILIO') FOR EMPDOM,
CONSTRAINT DC_EMPLEADO_TELEFONO DEFAULT('SIN TELEFONO') FOR EMPTELEFONO
GO
ALTER TABLE CLIENTES ADD CONSTRAINT DC_CLIENTES_DOMICILIO DEFAULT('SIN DOMICILIO') FOR CTEDOMICILIO,
CONSTRAINT DC_CLIENTES_TELEFONO DEFAULT('SIN TELEFONO') FOR CTETELEFONO, 
CONSTRAINT DC_CLIENTES_CELULAR DEFAULT ('SIN CELULAR') FOR CTECELULAR
GO
ALTER TABLE COLONIAS ADD CONSTRAINT DC_COLONIAS_CP DEFAULT ('00000') FOR COLCP
GO
--INSERCIONES DE TABLAS
--FAMILIAS



INSERT INTO FAMILIAS VALUES(1,'PEQUE�OS', 'ARTICULOS PEQUE�OS, PESO O GRAMO')



INSERT INTO FAMILIAS VALUES(2,'MEDIANOS', 'ARTICULOS MEDIANOS, PESO O COSTO')
INSERT INTO FAMILIAS VALUES(3,'GRANDES', 'ARTICULOS GRANDES, PESO O COSTO')
INSERT INTO FAMILIAS VALUES(4,'JARDIN', 'ARTICULOS DE JARDIN, COSTO')
INSERT INTO FAMILIAS VALUES(5,'PINTURAS', 'ARTICULOS DE PINTURA, COSTO')
GO --ARTICULOS
INSERT INTO ARTICULOS VALUES(300, 'TORNILLO', '3/4 CABEZA CRUZ', 1, 1)
INSERT INTO ARTICULOS VALUES(301, 'PALA', 'MANGO PLASTICO, PALO MADERA', 350, 4)
INSERT INTO ARTICULOS VALUES(302, 'PINTURA AEROSOL', 'ROJO METALICO', 40, 5)
INSERT INTO ARTICULOS VALUES(303, 'TUBO PVC', '1/2 BEIGE CON ROSCA 1.5 METROS', 80, 2)
INSERT INTO ARTICULOS VALUES(304, 'PINZAS ELECTRICAS', 'AZUL AISLANTE', 50, 3)
GO --ZONAS
INSERT INTO ZONAS VALUES (100, 'NORTE')
INSERT INTO ZONAS VALUES (102, 'SUR')
INSERT INTO ZONAS VALUES (104, 'ESTE')
INSERT INTO ZONAS VALUES (106, 'NOROESTE')
INSERT INTO ZONAS VALUES (108, 'CENTRO')
GO--MUNICIPIOS
INSERT INTO MUNICIPIOS VALUES (208, 'CULIACAN')
INSERT INTO MUNICIPIOS VALUES (308, 'MAZATLAN')
INSERT INTO MUNICIPIOS VALUES (408, 'CHOIX')
INSERT INTO MUNICIPIOS VALUES (508, 'GUASAVE')
INSERT INTO MUNICIPIOS VALUES (608, 'COSALA')
GO--COLONIAS
INSERT INTO COLONIAS VALUES (700, 'HUIZACHES','80290', 208)
INSERT INTO COLONIAS VALUES (701, 'LOMAS','90270', 508)
INSERT INTO COLONIAS VALUES (702, 'SABALO','85230', 308)
INSERT INTO COLONIAS VALUES (703, '5 MAYO','97250', 408)
INSERT INTO COLONIAS VALUES (704, 'SAN IGNACIO','20290', 608)
GO--CLIENTES
INSERT INTO CLIENTES VALUES(500, 'CARLOS','FELIX','RIOS','SAN ALLENDE #34','6671257670','6672113804','CARFLXPQR7VE8','FECA028027MSLLS201', '09/03/2000','M', 700) 
INSERT INTO CLIENTES VALUES(501, 'MARIA','COTA','LEON','10 DE MAYO #23','6671258942','6672125079','MACRTGS127184','MACO028027MSLLS015', '12/20/1975','F', 704) 
INSERT INTO CLIENTES VALUES(502, 'ESTER','EXPOSITO','ARCHULETA','QUINTAS #2','6671259851','6672101245','ESTXE02789431','ESEX028027MSLLS304', '03/14/1988','F', 702) 
INSERT INTO CLIENTES VALUES(503, 'CHRISTIAN','CASTILLO','LOPEZ','PLUTARCO #40','6671250148','6672101478','CHCAS8021875','CHCAS028027MSLLS58', '10/01/2002','M', 701) 
INSERT INTO CLIENTES VALUES(504, 'PEDRO','CAMPOS','DIAZ','LAZARO CARDENAS #21','6671254972','6672178924','CDESFT4572018','PECA028027MSLLS789', '08/25/1999','M', 703) 
GO--FERRETERIAS
INSERT INTO FERRETERIAS VALUES(600,'FERREGOM','CLAVEL#130','6671578942')
INSERT INTO FERRETERIAS VALUES(601,'FERRELUZ','ROMULO #1520','6671579943')
INSERT INTO FERRETERIAS VALUES(602,'FERRETUR','PORFIRIO#150','6671578944')
INSERT INTO FERRETERIAS VALUES(603,'FERRESOL','OBREGON #180','6671576945')
INSERT INTO FERRETERIAS VALUES(604,'FERRETOR','PALACIO #190','6671574946')
GO --EMPLEADOS
INSERT INTO EMPLEADOS VALUES(900,'ERIKA','FLORES','LOPEZ','JUAREZ 30', '6021578493', '0491570006', 'PHBCTA2480135','ESEX028027MSLLS304','05/10/2015','09/03/1990', 100, 900)
INSERT INTO EMPLEADOS VALUES(901,'MAR','FLORES','PEREZ','MEX 20', '8021578457', '5091570075', 'DNTIAA2480135','LALO038027MSLLS304','12/25/2015','09/03/2000', 102, 900)
INSERT INTO EMPLEADOS VALUES(902,'ANA','LOPEZ','OZUNA','LOMA LINDA 50', '9021578472', '8091570050', 'SNTYQA2480135','VERA098027MSLLS304','07/17/2014','09/03/2002', 106, 901)
INSERT INTO EMPLEADOS VALUES(903,'LUIS','CECE�A','PE�A','REYNOSA 10', '3021578484', '6491570098', 'VERTAA2480135','LOMO058027MSLLS304','03/03/2013','09/03/1995', 108, 902)
INSERT INTO EMPLEADOS VALUES(904,'PERLA','RENDON','LOPEZ','CDMX 50', '2021578490', '3991570064', 'BFTRUA2480135','TERE088027MSLLS304','02/12/2012','09/03/1998', 104, 902)
GO --VENTAS
INSERT INTO VENTAS VALUES (800, '08/09/2019',600,500,904)
INSERT INTO VENTAS VALUES (801, '08/09/2019',604,502,900)
INSERT INTO VENTAS VALUES (802, '09/09/2019',602,504,903)
INSERT INTO VENTAS VALUES (803, '09/09/2019',601,501,902)
INSERT INTO VENTAS VALUES (804, '10/09/2019',603,503,901)
GO --DETALLE 
INSERT INTO DETALLE VALUES (800, 302, 3, 120)
INSERT INTO DETALLE VALUES (804, 300, 50, 50)
INSERT INTO DETALLE VALUES (803, 301, 1, 350)
INSERT INTO DETALLE VALUES (802, 303, 3, 240)
INSERT INTO DETALLE VALUES (801, 304, 1, 50)
GO


